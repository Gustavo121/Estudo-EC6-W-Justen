<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>01 - Async/Await Intro</title>
</head>

<body>    
</body>

<script>
/*
    var posts = fetch('https://williamjusten.com.br/search.json');

    posts
        .then(data => data.json())
        .then(data => data.map(post => {
            console.log(post.title);
        }))
*/


// Colocando a promise em uma função os dados acima sem async await
/*
    function getPosts() {
        return fetch('https://williamjusten.com.br/search.json')
                    .then(data => data.json())
                    .then(data => data.map(post => {
                    console.log(post.title);
                    }));
    }

    getPosts();
*/

// Utilizando async await na função

    async function getPosts() { // async garante que o codigo é assincrono e precisamos da outra palavra chave await
        const response = await fetch('https://williamjusten.com.br/search.json') // fetch funciona com base em uma promise( ou seja await fala para esperar essa promise ser resolvida, assim retorna algo para 'const response')
        const data = await response.json(); // transformando em json, para retorna o valor coloca await novamente
        
        return data.map(post => {
            console.log(post.title);
        });
    }

    getPosts();


    /*
    Básico

    - async/await funciona obrigatoriamente no protocolo de Promises ( somente dentro de promises resolvidas ou não)
    - async é uma palavra chave usada no inicio de uma função
    - await é usado para avisar a função para esperar o resultado da Promise
    - await só pode ser usado para uma função com async
    - async/await já está funcionando em quase todos os Browsers e NodeJS


    Vantagens de usar async/await

    - O código fica mais simplificado
    - Mais fácil de debugar por ter menos callbacks
    - A conversão de uma promise para async/await é bem mais simples
    - O código fica com menos encadeamentos
    */

</script>

</html>